$pattern = 'CVE-\d{4}-\d{4,7}'
del .\content.txt -Force
$sites = Get-Content .\feeds.txt
foreach($site in $sites){
$feed = iwr -ur $site -UseBasicParsing
$feed.Content | Out-File content.txt -Append
$feed.Links -match $pattern
}
Get-Content .\content.txt

-split (Get-Content .\content.txt | Out-String) | 
Where-Object { $_ -eq "CVE-2022-26134" } | Measure-Object |
Select-Object -exp count

$FileContent = Get-Content .\content.txt
$Matches = Select-String -InputObject $FileContent -Pattern $pattern -AllMatches

#$Matches = Select-String -InputObject $FileContent -Pattern "cve-2016-0034" -AllMatches
#$Matches.Matches.Count

write-host "TOP CVEs" -ForegroundColor Red
$top = $Matches.Matches | Group-Object -Property Value
#$top | Sort-Object -Property count -Descending | Select-Object -First 20
$top | Sort-Object -Descending -Property count | Select-Object -First 5 | select -Property Name, Count
